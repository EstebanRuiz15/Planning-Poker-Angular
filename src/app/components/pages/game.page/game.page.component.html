<main class="game-page-container">
  <header class="logo-container" id="logoContainer">
    <img src="../assets/images/ficha-de-poker.png" alt="Logo">
  </header>
  <h1 class="game-name">{{ gameName }}</h1>

  <header class="header-buttons">
    <div class="user-circle" *ngIf="userName">
      <span>{{ getInitials(userName) }}</span>
    </div>
    <button class="custom-button" (click)="copyInvitationLink()">Invitar jugadores</button>
  </header>

  <section class="table-container">
    <app-table-game
      #tableGame
      [votedCards]="gameState === 'completed' ? gameVotes : {}"
      [currentUserVote]="getCurrentUserVote()"
    ></app-table-game>
  </section>

  <section class="cart-container">
    <ng-container *ngIf="!isGameComplete">
      <app-cart
        *ngFor="let number of fibonacciNumbers"
        [number]="number"
        [isVoted]="getCurrentUserVote().vote === number"
        (cardSelected)="vote(number)"
        [disabled]="!isPlayerRole() || currentUserVote !== null"
      ></app-cart>
      <app-cart
        [disabled]="!isPlayerRole() || currentUserVote !== null"
        [number]="'?'"
      ></app-cart>
      <app-cart
        [number]="'â˜•'"
        [disabled]="!isPlayerRole() || currentUserVote !== null"
      ></app-cart>
    </ng-container>

    <ng-container *ngIf="isGameComplete">
      <ng-container *ngFor="let voteInfo of getUniqueVotes()">
        <app-cart
          [number]="voteInfo.vote"
          [votes]="voteInfo.count"
        ></app-cart>
      </ng-container>
    </ng-container>
  </section>
  <div *ngIf="isGameComplete" class="average-container">
    <p class="average-text">Promedio:</p>
    <p class="average-value">{{ getAverageVote() | number: '1.0-2' }}</p>
  </div>

  <div *ngIf=" isAdmin && !isGameComplete" class="buton-cont">
    <app-button
      [disabled]="!canRevealVotes()"
      (onClick)="revealVotes()"
    >
      Revelar Cartas
    </app-button>
  </div>
  <div *ngIf="isGameComplete && isAdmin" class="restart-button-container">
    <app-button (onClick)="restartGame()" [disabled]="isGameComplete">
      <mat-icon>replay</mat-icon> Reiniciar
    </app-button>
  </div>
</main>
